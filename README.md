<<<<<<< HEAD
# XDS åŠŸç‡è®¡ PC æ•°æ®ç›‘è§†å·¥å…·ï¼ˆXdsWokSpaceï¼‰

**XdsWokSpace** æ˜¯ä¸€æ¬¾ä¸“ä¸º XDSï¼ˆå–œå¾·ç››ï¼‰åŠå…¼å®¹ BLE
åè®®çš„è‡ªè¡Œè½¦åŠŸç‡è®¡å¼€å‘çš„ **Windows ç«¯è“ç‰™ç›‘è§†å·¥å…·**ã€‚\
é€šè¿‡è¯¥å·¥å…·ï¼Œä½ å¯ä»¥åœ¨æ— éœ€æ‰‹æœº App
çš„æƒ…å†µä¸‹å®æ—¶ç›‘æ§åŠŸç‡è®¡æ•°æ®ï¼Œå¹¶è¿›è¡Œè°ƒè¯•ã€éªŒè¯ä¸æ•°æ®åˆ†æã€‚

------------------------------------------------------------------------

## ğŸš´ é¡¹ç›®ç‰¹ç‚¹ä¸æ ¸å¿ƒåŠŸèƒ½

### âš¡ å®æ—¶ç›‘æµ‹

-   **åŠŸç‡ï¼ˆPowerï¼‰**ï¼šå®æ—¶åŠŸç‡ / å¹³å‡åŠŸç‡ / å³°å€¼åŠŸç‡\
-   **è¸é¢‘ï¼ˆCadenceï¼‰**ï¼šç²¾å‡†è®¡ç®— RPMï¼Œå…·å¤‡è‡ªåŠ¨å½’é›¶ä¸é˜²æŠ–é€»è¾‘\
-   **å·¦å³å¹³è¡¡ï¼ˆL/R Balanceï¼‰**ï¼šæ˜¾ç¤ºå·¦å³è…¿è¾“å‡ºæ¯”ä¾‹\
-   **è§’åº¦ï¼ˆAngleï¼‰**ï¼šæ›²æŸ„å®æ—¶è§’åº¦\
-   **è®¾å¤‡çŠ¶æ€ç ï¼ˆErrorï¼‰**

### ğŸ” è®¾å¤‡æ‰«æä¸è¿‡æ»¤

-   è‡ªåŠ¨æ‰«æé™„è¿‘ BLE è®¾å¤‡\
-   æ™ºèƒ½åŒ¹é…åç§°å« `XDS`ã€`Power` çš„è®¾å¤‡\
-   æ˜¾ç¤ºä¿¡å·å¼ºåº¦ RSSI\
-   æ”¯æŒé‡æ–°æ‰«æ / æ‰‹åŠ¨é€‰æ‹©è®¾å¤‡

### ğŸ”Œ ç¨³å®šè¿æ¥ä¸æ¢å¤

-   è‡ªåŠ¨ä¿æŒè¿æ¥\
-   æ–­çº¿è‡ªåŠ¨æ£€æµ‹\
-   æ•°æ®ä¸­æ–­åçš„è‡ªåŠ¨é‡è¿æœºåˆ¶

### ğŸ“Š ç»Ÿè®¡åŠŸèƒ½

-   ç»Ÿè®¡éª‘è¡Œæ—¶é•¿\
-   å¹³å‡è¸é¢‘æ™ºèƒ½è®¡ç®—ï¼ˆè¿‡æ»¤è¸©è¸åŒºé—´ï¼‰\
-   å¹³å‡åŠŸç‡ä¸æœ€å¤§åŠŸç‡è·Ÿè¸ª

------------------------------------------------------------------------

### ğŸ“‚ é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜

```text
XdsWokSpace/                                      â† é¡¹ç›®æ ¹ç›®å½•
â”‚                                                 å­˜æ”¾æ•´ä¸ªå·¥ç¨‹çš„æ‰€æœ‰æºä»£ç ã€åº“ä¸é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“‚ Library/                                   [ç¬¬ä¸‰æ–¹ä¾èµ–åº“ç›®å½•]
â”‚   â”‚                                             é¡¹ç›®ç¼–è¯‘æ‰€éœ€çš„å¤–éƒ¨ä¾èµ–ç»Ÿä¸€æ”¾ç½®äºæ­¤ï¼Œ
â”‚   â”‚                                             ï¼ˆæ— éœ€é¢å¤–å®‰è£…ç¯å¢ƒï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ include/                               [å¤´æ–‡ä»¶ç›®å½•]
â”‚   â”‚      â”œâ”€â”€ SimpleBLE/                         SimpleBLE çš„ C++ å¤´æ–‡ä»¶ï¼ˆè“ç‰™æ“ä½œ APIï¼‰
â”‚   â”‚      â”œâ”€â”€ fmt/                               fmt æ ¼å¼åŒ–åº“å¤´æ–‡ä»¶
â”‚   â”‚      â””â”€â”€ å…¶ä»– .h/.hpp                       å…¶å®ƒç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶
â”‚   â”‚
â”‚   â”‚      ï¼ˆä½œç”¨ï¼‰
â”‚   â”‚      âœ” æä¾›å¤–éƒ¨åº“çš„å‡½æ•°ã€ç±»ã€ç»“æ„ä½“å£°æ˜
â”‚   â”‚      âœ” main.cpp / ble_manager.cpp ä¼šé€šè¿‡ #include è°ƒç”¨è¿™äº›æ¥å£
â”‚   â”‚      âœ” VS é¡¹ç›®ä¼šå°†æ­¤ç›®å½•åŠ å…¥â€œé™„åŠ åŒ…å«ç›®å½•ï¼ˆInclude Directoriesï¼‰â€
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ lib/                                   [é™æ€åº“ç›®å½•]
â”‚          â”œâ”€â”€ SimpleBLE.lib                      SimpleBLE é¢„ç¼–è¯‘åº“ï¼Œè´Ÿè´£ BLE åº•å±‚å®ç°
â”‚          â”œâ”€â”€ fmt.lib                            fmt çš„é™æ€åº“
â”‚          â””â”€â”€ otherlibs.lib                      å…¶ä»–å¯èƒ½ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“
â”‚
â”‚          ï¼ˆä½œç”¨ï¼‰
â”‚          âœ” ç¼–è¯‘é“¾æ¥é˜¶æ®µç”± VS é“¾æ¥å™¨åŠ è½½
â”‚          âœ” å°†åº•å±‚è“ç‰™ã€æ ¼å¼åŒ–ç­‰åŠŸèƒ½åµŒå…¥æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­
â”‚          âœ” é¿å…ç”¨æˆ·æœ¬æœºå¿…é¡»å®‰è£… SimpleBLE
â”‚
â”œâ”€â”€ ğŸ“‚ src/                                       [æ ¸å¿ƒæºä»£ç ç›®å½•]
â”‚   â”‚                                             æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ä¸ç¨‹åºæ ¸å¿ƒåŠŸèƒ½å‡åœ¨æ­¤å®ç°
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ main.cpp                               [ç¨‹åºå…¥å£]
â”‚   â”‚      ï¼ˆä¸»è¦èŒè´£ï¼‰
â”‚   â”‚      1. åˆå§‹åŒ–ç¨‹åºç¯å¢ƒï¼ˆæ—¥å¿—ã€æ—¶é—´ã€è“ç‰™æ¨¡å—ç­‰ï¼‰
â”‚   â”‚      2. åˆ›å»º BLE ç®¡ç†å¯¹è±¡ï¼ˆBleManagerï¼‰å¹¶å¯åŠ¨æ‰«æ
â”‚   â”‚      3. å‘ç°ç›®æ ‡åŠŸç‡è®¡åå‘èµ·è¿æ¥
â”‚   â”‚      4. è®¾ç½® Notify å›è°ƒ â†’ å½“æ¥æ”¶åˆ°è“ç‰™æ•°æ®æ—¶è°ƒç”¨ data_parser
â”‚   â”‚      5. æ§åˆ¶ç¨‹åºä¸»å¾ªç¯ï¼šäº‹ä»¶å¤„ç†ã€å¼‚å¸¸æ•è·ã€é€€å‡ºé€»è¾‘
â”‚   â”‚      6. è¾“å‡ºå®æ—¶åŠŸç‡ã€è¸é¢‘ç­‰è§£æç»“æœ
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ ble_manager.cpp                        [è“ç‰™ç®¡ç†æ¨¡å—]
â”‚   â”‚      ï¼ˆä¸»è¦èŒè´£ï¼‰
â”‚   â”‚      1. å°è£… SimpleBLE APIï¼ˆAdapterã€Peripheralã€Characteristicï¼‰
â”‚   â”‚      2. æ‰§è¡Œè®¾å¤‡æ‰«æ â†’ å¹¶æŒ‰æ¡ä»¶è¿‡æ»¤ï¼ˆåç§°/UUID/MAC ç­‰ï¼‰
â”‚   â”‚      3. å»ºç«‹è¿æ¥å¹¶å‘ç°ç‰¹å¾å€¼ï¼ˆCharacteristicï¼‰
â”‚   â”‚      4. è®¢é˜… Notify â†’ æ¥æ”¶åŠŸç‡è®¡å®æ—¶å¹¿æ’­æ•°æ®
â”‚   â”‚      5. å¤„ç†æ–­çº¿ã€é‡è¿ã€è“ç‰™å¼‚å¸¸ç­‰æƒ…å†µ
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ data_parser.cpp                        [æ•°æ®è§£ææ¨¡å—]
â”‚   â”‚      ï¼ˆä¸»è¦èŒè´£ï¼‰
â”‚   â”‚      1. æ¥æ”¶æ¥è‡ª BLE çš„åŸå§‹å­—èŠ‚æµ RawDataï¼ˆuint8_t[]ï¼‰
â”‚   â”‚      2. æŒ‰ç…§åŠŸç‡è®¡åè®®è§£æå­—æ®µï¼š
â”‚   â”‚          â€¢ åŠŸç‡å€¼ï¼ˆInstant Powerï¼‰
â”‚   â”‚          â€¢ è¸é¢‘ï¼ˆCadenceï¼‰
â”‚   â”‚          â€¢ æ‰­çŸ©ï¼ˆTorqueï¼‰
â”‚   â”‚          â€¢ æ—¶é—´æˆ³/è®¡æ•°å™¨ç­‰æ•°æ®
â”‚   â”‚      3. æ ¡éªŒæ•°æ®é•¿åº¦ã€CRC/æ ¡éªŒå’Œã€å¼‚å¸¸å€¼è¿‡æ»¤
â”‚   â”‚      4. è¾“å‡ºç»“æ„åŒ–æ•°æ®ï¼ˆPowerData ç»“æ„ä½“ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ utils.cpp                              [é€šç”¨å·¥å…·æ¨¡å—]
â”‚          ï¼ˆä¸»è¦èŒè´£ï¼‰
â”‚          âœ” å­—èŠ‚æ•°ç»„è½¬åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆè°ƒè¯•ç”¨ï¼‰
â”‚          âœ” å°ç«¯å­—èŠ‚åºè½¬ int16/int32
â”‚          âœ” æ—¶é—´æˆ³è·å–ä¸é—´éš”è®¡ç®—ï¼ˆç”¨äºåˆ¤æ–­è¶…æ—¶/æ‰çº¿ï¼‰
â”‚          âœ” æ—¥å¿—è¾…åŠ©è¾“å‡º/æ ¼å¼åŒ–
â”‚          âœ” å¸¸ç”¨æ•°å­¦æˆ–æ ¼å¼åŒ–å·¥å…·
â”‚
â”œâ”€â”€ ğŸ“„ XdsWokSpace.vcxproj                        [VS é¡¹ç›®é…ç½®æ–‡ä»¶]
â”‚       ï¼ˆä½œç”¨ï¼‰
â”‚       â€¢ å®šä¹‰ C++ ç¼–è¯‘å™¨è®¾ç½®ï¼ˆæ ‡å‡†ã€é¢„å¤„ç†å®ç­‰ï¼‰
â”‚       â€¢ æŒ‡å®š src/ ä¸ Library/include çš„è·¯å¾„
â”‚       â€¢ æŒ‡å®š Library/lib çš„é“¾æ¥è·¯å¾„
â”‚       â€¢ æŒ‡å®šè¦é“¾æ¥çš„ .lib æ–‡ä»¶ï¼ˆå¦‚ SimpleBLE.libï¼‰
â”‚       â€¢ å®šä¹‰ Debug/Releaseã€x64/x86 ç¼–è¯‘é…ç½®
â”‚
â”œâ”€â”€ ğŸ“„ XdsWokSpace.sln                            [VS è§£å†³æ–¹æ¡ˆæ–‡ä»¶]
â”‚       ï¼ˆä½œç”¨ï¼‰
â”‚       â€¢ Visual Studio çš„é¡¹ç›®å…¥å£
â”‚       â€¢ åŒ…å«é¡¹ç›®ç»„ç»‡ç»“æ„ã€è°ƒè¯•é…ç½®ã€ä¾èµ–å…³ç³»ç­‰
â”‚       â€¢ åŒå‡»å³å¯åœ¨ VS æ‰“å¼€æ•´ä¸ªå·¥ç¨‹
â”‚
â””â”€â”€ ğŸ“„ README.md                                  [é¡¹ç›®è¯´æ˜æ–‡æ¡£]
        âœ” é¡¹ç›®ç®€ä»‹ï¼ˆBLE åŠŸç‡è®¡è§£æå·¥å…·ï¼‰
        âœ” ç¼–è¯‘è¿è¡Œæ­¥éª¤
        âœ” ä¾èµ–åº“è¯´æ˜ï¼ˆSimpleBLEï¼‰
        âœ” å¦‚ä½•æ‰«æã€è¿æ¥è®¾å¤‡
        âœ” å¸¸è§é—®é¢˜
```

------------------------------------------------------------------------

## ğŸ› ï¸ æ„å»ºç¯å¢ƒä¸ä¾èµ–

### å¿…è¦ç¯å¢ƒ

-   **Windows 10 / 11**
-   å¿…é¡»å¸¦ **è“ç‰™ 4.0+** ï¼ˆBLEï¼‰åŠŸèƒ½çš„ç”µè„‘ï¼ˆå¦åˆ™æ— æ³•æ‰«æåˆ°è“ç‰™è®¾å¤‡ï¼‰

### é¡¹ç›®ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“

-   **SimpleBLE**ï¼ˆæ ¸å¿ƒ BLE é€šä¿¡åº“ï¼‰
-   **fmt**ï¼ˆæ ¼å¼åŒ–è¾“å‡ºåº“ï¼‰

é¡¹ç›®å·²åŒ…å«æ‰€æœ‰å¿…é¡»ä¾èµ–ï¼Œæ— éœ€é¢å¤–ä¸‹è½½ï¼Œåªéœ€ä¿è¯ `Library`
æ–‡ä»¶å¤¹å®Œæ•´å³å¯ã€‚

### ç¼–è¯‘æ­¥éª¤

1.  ä½¿ç”¨ VS æ‰“å¼€ `XdsWokSpace.sln`

2.  é€‰æ‹©ï¼š

    -   é…ç½®ï¼š**Release**\
    -   å¹³å°ï¼š**x64**

3.  ç‚¹å‡» **"ç”Ÿæˆè§£å†³æ–¹æ¡ˆ"**

4.  æˆåŠŸåè¿è¡Œï¼š

        x64/Release/XdsWokSpace.exe

------------------------------------------------------------------------

## ğŸ“– ä½¿ç”¨æ•™ç¨‹ï¼ˆè¶…è¯¦ç»†ç‰ˆï¼‰

### ç¬¬ 1 æ­¥ï¼šå‡†å¤‡åŠŸç‡è®¡ä¸ç”µè„‘

1.  æ‰“å¼€ç”µè„‘è“ç‰™\
2.  è½»æ‹ä¸‰ä¸‹å”¤é†’åŠŸç‡è®¡\
3.  **åŠ¡å¿…å…³é—­æ‰‹æœºéª‘è¡Œè½¯ä»¶ä¸è“ç‰™è¿æ¥**

------------------------------------------------------------------------

### ç¬¬ 2 æ­¥ï¼šå¯åŠ¨ç¨‹åºå¹¶è‡ªåŠ¨æ‰«æ

è¿è¡Œ `XdsWokSpace.exe` åï¼Œä¼šè‡ªåŠ¨è¿›è¡Œçº¦ 5 ç§’çš„æ‰«æã€‚\
æ‰«æåæ˜¾ç¤ºç±»ä¼¼ä»¥ä¸‹ç•Œé¢ï¼š

    ---------------------------------------------------------------
     ID | è®¾å¤‡åç§° (Identifier) | MAC åœ°å€          | ä¿¡å· | UUIDs
    ---------------------------------------------------------------
    â­[0] XDS Power Meter        | C3:32:01:03:xx:xx | -62  | ...
      [1] Unnamed                | 9A:CD:xx:xx:xx:xx | -80  | ...
    ---------------------------------------------------------------

å«ä¹‰è¯´æ˜ï¼š

-   `â­`ï¼šè‡ªåŠ¨æ¨èè¿æ¥çš„è®¾å¤‡\
-   è¾“å…¥ `IDï¼ˆå¦‚ 0ï¼‰` è¿æ¥è®¾å¤‡\
-   è¾“å…¥ï¼š
    -   `r` â†’ é‡æ–°æ‰«æ\
    -   `q` â†’ é€€å‡ºç¨‹åº

------------------------------------------------------------------------

### ç¬¬ 3 æ­¥ï¼šå®æ—¶ç›‘æ§ç•Œé¢è¯´æ˜

æˆåŠŸè¿æ¥åä½ å°†çœ‹åˆ°ï¼š

    [02:15] PWR: 185/150/428W | CAD: 85/82 | L/R: 48/52 | Ang: 124Â° | E:0

å­—æ®µè¯´æ˜ï¼š

  å­—æ®µ        å«ä¹‰       è¯´æ˜
  ----------- ---------- ------------------------------
  `[MM:SS]`   è¿è¡Œæ—¶é—´   è¿æ¥åçš„æ—¶é•¿
  `PWR`       åŠŸç‡       å®æ—¶ / å¹³å‡ / æœ€å¤§
  `CAD`       è¸é¢‘       å®æ—¶ RPM / å¹³å‡ RPM
  `L/R`       å·¦å³å¹³è¡¡   å·¦è…¿ / å³è…¿ å æ¯”
  `Ang`       è§’åº¦       æ›²æŸ„å½“å‰è§’åº¦
  `E`         é”™è¯¯ç      0 ä¸ºæ­£å¸¸ï¼Œå…¶ä»–ä¸ºç¡¬ä»¶è¿”å›çŠ¶æ€

------------------------------------------------------------------------

### ç¬¬ 4 æ­¥ï¼šé€€å‡ºç¨‹åº

æŒ‰ **Ctrl + C** å³å¯å®‰å…¨æ–­è¿ã€‚

------------------------------------------------------------------------

## â“ å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

### 1. æ‰«æä¸åˆ°åŠŸç‡è®¡ï¼Ÿ

è¯·æ£€æŸ¥ï¼š - åŠŸç‡è®¡æ˜¯å¦è¢«æ‰‹æœº App å ç”¨\
- æ˜¯å¦å·²å”¤é†’è®¾å¤‡\
- ç”µè„‘è“ç‰™æ˜¯å¦æ­£å¸¸ï¼Œæ˜¯å¦æ”¯æŒè“ç‰™ 4.0+\
- å¤šæ¬¡è¾“å…¥ `r` é‡æ–°æ‰«æ

### 2. è¿æ¥åæ²¡æœ‰æ•°æ®ï¼Ÿ

-   æ›²æŸ„æœªæ—‹è½¬\
-   æ•°æ®åŒ…æœªå‘é€\
-   BLE è¿æ¥å‡ºç°ç¼“å­˜å¼‚å¸¸ â†’ æ–­å¼€é‡è¿å³å¯

### 3. è¸é¢‘ä¸€ç›´ä¸º 0ï¼Ÿ

-   ç¨‹åºå†…ç½®é˜²æŠ–ï¼Œéœ€è¦è¿ç»­è¸©è¸\
-   åœæ­¢è¸©è¸è¶…è¿‡ 2.5s è¸é¢‘è‡ªåŠ¨å½’é›¶
------------------------------------------------------------------------
### é¡¹ç›®è¿ä½œæµç¨‹å›¾

```mermaid
flowchart TD
    %% --- å®šä¹‰èŠ‚ç‚¹æ ·å¼ ---
    classDef process fill:#e3f2fd,stroke:#1565c0,stroke-width:2px;
    classDef decision fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;
    classDef terminator fill:#ffcdd2,stroke:#c62828,stroke-width:2px;
    classDef storage fill:#f0f4c3,stroke:#827717,stroke-width:2px;
    classDef async fill:#e1bee7,stroke:#4a148c,stroke-width:2px,stroke-dasharray: 5 5;

    %% --- ä¸»ç¨‹åºå…¥å£ ---
    Start((ç¨‹åºå¯åŠ¨<br>main)):::terminator --> SetSignal[è®¾ç½®ä¿¡å·å¤„ç†<br>SIGINT]:::process
    SetSignal --> InitMonitor[å®ä¾‹åŒ– XdsMonitor]:::process
    InitMonitor --> RunMonitor[è°ƒç”¨ monitor.run]:::process

    %% --- XdsMonitor::run() ä¸»é€»è¾‘ ---
    subgraph MainLoop [ğŸ” ä¸»è¿è¡Œå¾ªç¯ / XdsMonitor::run]
        direction TB
        
        RunMonitor --> InitAdapter{åˆå§‹åŒ–é€‚é…å™¨<br>initAdapter}:::decision
        InitAdapter -- å¤±è´¥ --> EndProgram((é€€å‡ºç¨‹åº)):::terminator
        InitAdapter -- æˆåŠŸ --> ScanStep[è°ƒç”¨ scanAndSelectDevice]:::process

        %% æ‰«æä¸é€‰æ‹©é€»è¾‘
        ScanStep --> BLEScan[æ‰§è¡Œ BLE æ‰«æ 5ç§’]:::process
        BLEScan --> ShowList[æ‰“å°è®¾å¤‡åˆ—è¡¨]:::process
        ShowList --> CheckAuto{æ˜¯å¦è‡ªåŠ¨é‡è¿?}:::decision
        
        CheckAuto -- æ˜¯ --> SetTarget[é”å®šä¸Šæ¬¡è®¾å¤‡]:::process
        CheckAuto -- å¦ --> UserInput[/ç”¨æˆ·è¾“å…¥ ID/r/q/]:::storage
        
        UserInput -- "q (é€€å‡º)" --> EndProgram
        UserInput -- "r (é‡è¯•)" --> BLEScan
        UserInput -- "ID (é€‰ä¸­)" --> SetTarget

        %% è¿æ¥é€»è¾‘
        SetTarget --> ConnectStep[è°ƒç”¨ connectDevice]:::process
        ConnectStep --> DoConn{è¿æ¥æˆåŠŸ?}:::decision
        
        DoConn -- å¦ --> WaitRetry[ç­‰å¾… 3ç§’]:::process
        WaitRetry --> BLEScan
        
        DoConn -- æ˜¯ --> FindSvc{å‘ç°æœåŠ¡/ç‰¹å¾å€¼?<br>1828 / 2a63}:::decision
        FindSvc -- å¦ --> Disconnect[æ–­å¼€è¿æ¥]:::process
        Disconnect --> WaitRetry
        
        %% ç›‘æ§é€»è¾‘
        FindSvc -- æ˜¯ --> StartMon[è°ƒç”¨ startMonitoring]:::process
    end

    %% --- ç›‘æ§ä¸æ•°æ®æµ ---
    subgraph MonitorLogic [âš¡ ç›‘æ§é˜¶æ®µ / startMonitoring]
        direction TB
        StartMon --> Subscribe[è®¢é˜… Notify å›è°ƒ]:::process
        Subscribe --> InitStats[é‡ç½®ç»Ÿè®¡æ•°æ®<br>startTime, maxPower...]:::process
        
        %% ä¿æŒè¿æ¥çš„å¾ªç¯
        InitStats --> CheckConn{æ£€æŸ¥è¿æ¥çŠ¶æ€<br>& è¶…æ—¶}:::decision
        CheckConn -- "è¿æ¥æ–­å¼€/ç”¨æˆ·åœæ­¢" --> Unsub[å–æ¶ˆè®¢é˜… & æ–­å¼€]:::process
        Unsub --> WaitReconnect[å‡†å¤‡é‡è¿]:::process
        WaitReconnect --> BLEScan
        
        CheckConn -- "æ­£å¸¸è¿è¡Œ" --> Sleep[Sleep 100ms]:::process
        Sleep --> CheckConn
    end

    %% --- å¼‚æ­¥æ•°æ®å¤„ç†å›è°ƒ ---
    subgraph DataPipeline [âš™ï¸ æ•°æ®å¤„ç†æµæ°´çº¿ / onDataReceived]
        direction TB
        
        %% è§¦å‘æº
        BLEEvent(BLE Notify äº‹ä»¶):::async -.-> |ByteArray| ParseRaw[è§£æåŸå§‹æ•°æ®]:::process
        
        %% 1. åŸºç¡€è§£æ
        ParseRaw --> GetVal1[è§£æ Power/L/R/Angle<br>getUnsigned/SignedValue]:::process
        
        %% 2. è¸é¢‘ç®—æ³•
        GetVal1 --> CalcCadence{æ˜¯ç¬¬ä¸€ä¸ªåŒ…?}:::decision
        CalcCadence -- æ˜¯ --> InitCadence[è®°å½•åˆå§‹åœˆæ•°]:::process
        CalcCadence -- å¦ --> DiffCalc[è®¡ç®—åœˆæ•°å·® & æ—¶é—´å·®]:::process
        DiffCalc --> ValidDiff{å·®å€¼æœ‰æ•ˆ?}:::decision
        ValidDiff -- "æ˜¯ (>0)" --> ComputeRPM[è®¡ç®—ç¬æ—¶ RPM]:::process
        ValidDiff -- "å¦ (è¶…æ—¶>2.5s)" --> ZeroRPM[RPM ç½® 0]:::process
        
        %% 3. ç»Ÿè®¡æ›´æ–°
        ComputeRPM --> UpdateStatsCalc[æ›´æ–°ç»Ÿè®¡æ•°æ®<br>Avg/Max Power, Balance]:::process
        ZeroRPM --> UpdateStatsCalc
        InitCadence --> UpdateStatsCalc
        
        %% 4. UI è¾“å‡º
        UpdateStatsCalc --> PrintUI[/æ ¼å¼åŒ–æ‰“å° Console<br>æ¸…é™¤å½“å‰è¡Œå¹¶åˆ·æ–°/]:::storage
    end

    %% å…³è”å…³ç³»
    Subscribe -.-> |æ³¨å†Œå›è°ƒ| BLEEvent
```